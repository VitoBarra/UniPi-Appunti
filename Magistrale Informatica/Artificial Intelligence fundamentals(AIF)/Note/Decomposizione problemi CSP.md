---
Course: "[[Artificial Intelligence Fundamentals (AIF)]]"
tags:
  - AIF
Area: 
topic: 
SubTopic: 
---

# Decomposizione problemi CSP
---
La struttura del problema, rappresentata attraverso il grafo dei vincoli, riveste un ruolo fondamentale nell'ottimizzazione dei processi risolutivi nei problemi di soddisfacimento di vincoli (CSP), così come in altre aree come il ragionamento probabilistico. La complessità della realtà impone un approccio di decomposizione in sottoproblemi indipendenti. L'analisi del grafo dei vincoli relativo al problema della colorazione dell'Australia evidenzia un esempio significativo: la regione della Tasmania risulta isolata dal resto della rete di vincoli. Questa separazione implica che la colorazione della Tasmania e quella della terraferma costituiscono sottoproblemi indipendenti, tali per cui una qualsiasi combinazione delle rispettive soluzioni fornisce una soluzione valida per l'intero problema.

La determinazione dell'indipendenza tra sottoproblemi si basa sull'individuazione delle componenti connesse del grafo dei vincoli. Ogni componente definisce un sottoproblema $CSP_i$ e l'unione delle soluzioni parziali $\bigcup_i S_i$ rappresenta una soluzione complessiva $\bigcup_i CSP_i$. Questo approccio consente un'efficienza computazionale significativa: supponendo che ogni sottoproblema coinvolga $c$ variabili su un totale $n$, con $c$ costante, il numero di sottoproblemi è $n/c$ e la complessità per ciascuno è al massimo $d^c$, con $d$ dimensione del dominio. La complessità totale diventa $O(d^c \cdot n/c)$, dunque lineare rispetto a $n$, contrapposta all'approccio diretto con complessità esponenziale $O(d^n)$.

In aggiunta ai sottoproblemi completamente indipendenti, particolari strutture del grafo rendono la risoluzione notevolmente più efficiente. Un caso rilevante è rappresentato dai grafi ad albero, caratterizzati dall'esistenza di un unico percorso tra ogni coppia di variabili. La risoluzione di un CSP strutturato ad albero è resa possibile attraverso il concetto di coerenza direzionale sugli archi (Directional Arc Consistency, DAC). Si definisce un CSP direzionalmente arc-consistente rispetto ad un ordinamento delle variabili $X_1, X_2, \dots, X_n$ se ogni $X_i$ è arc-consistente con ogni $X_j$ tale che $j > i$.

Per rendere un grafo ad albero direzionalmente arc-consistente, si sceglie una variabile radice e si ordina il resto delle variabili in modo che ogni variabile compaia dopo il proprio genitore secondo un ordinamento topologico. Un grafo con $n$ nodi e $n - 1$ archi può essere reso arc-consistente in $O(n)$ operazioni, ciascuna richiedente al massimo $d^2$ confronti tra valori di dominio, per una complessità complessiva di $O(nd^2)$. Una volta garantita la coerenza direzionale, si procede nell'assegnazione dei valori in maniera sequenziale senza necessità di backtracking, data la sicurezza di disponibilità di un valore coerente per ogni variabile figlia rispetto al valore del genitore.

L'efficienza di questo metodo ha stimolato lo sviluppo di strategie per trasformare grafi generali in strutture ad albero. Una tecnica è il *cutset conditioning*, che consiste nell'assegnare valori a un sottoinsieme di variabili $S$ tale che la rimozione di $S$ dal grafo generi una struttura ad albero. Tale insieme $S$ è definito *cycle cutset*. Per ogni possibile assegnazione coerente delle variabili in $S$, si eliminano dai domini delle rimanenti variabili i valori incompatibili e si risolve il sottoproblema ad albero risultante. La complessità è $O(d^c \cdot (n - c)d^2)$, dove $c = |S|$. Se $c$ è sufficientemente piccolo, il miglioramento rispetto al backtracking esponenziale è sostanziale. Tuttavia, la ricerca del *cycle cutset* minimo è un problema NP-hard, sebbene esistano algoritmi approssimati efficaci.

Un approccio alternativo è la *tree decomposition*, ovvero la trasformazione del grafo in un albero i cui nodi rappresentano insiemi di variabili. La decomposizione deve soddisfare tre requisiti: ogni variabile deve comparire almeno una volta nei nodi dell'albero, ogni coppia di variabili con vincolo diretto deve comparire insieme in almeno un nodo, e una variabile che appare in più nodi deve essere presente in ogni nodo lungo il cammino che li connette. Questa struttura garantisce la consistenza globale dei valori assegnati alle variabili replicate nei nodi.

La risoluzione del problema avviene trattando ogni nodo come una variabile i cui valori sono tuple di assegnazioni compatibili con i vincoli locali. L'algoritmo TREE-CSP-SOLVER consente di risolvere il CSP in $O(nd^2)$, con $n$ numero di nodi e $d$ dimensione del dominio più ampio. Tuttavia, il dominio in questo contesto rappresenta un insieme di tuple, la cui dimensione cresce esponenzialmente con il numero di variabili per nodo. La *tree width* della decomposizione, definita come la dimensione massima dei nodi meno uno, influenza la complessità che diventa $O(nd^{w+1})$. La ricerca della decomposizione a larghezza minima è anch'essa NP-hard, ma in pratica si adottano euristiche per ottenere decomposizioni sufficientemente compatte.

Si osserva che se esiste un *cycle cutset* di dimensione $c$, allora la *tree width* è minore di $c + 1$, potenzialmente molto inferiore. Sebbene la decomposizione ad albero sia computazionalmente vantaggiosa, essa richiede memoria esponenziale rispetto alla *tree width*, mentre il *cutset conditioning* utilizza memoria lineare.

Infine, la simmetria nei valori delle variabili, detta *value symmetry*, può ampliare inutilmente lo spazio delle soluzioni. La permutazione dei valori che genera soluzioni equivalenti può essere eliminata attraverso vincoli di rottura della simmetria (*symmetry-breaking constraint*), imponendo un ordinamento arbitrario sui valori assegnati alle variabili, riducendo lo spazio di ricerca di un fattore $d!$. Sebbene sia in generale NP-hard eliminare tutte le simmetrie, la riduzione parziale dello spazio simmetrico si è dimostrata efficace in molteplici contesti applicativi.
